{
  "section_key": "self_improvement_system",
  "protocol_id": "leo-v4-3-3-ui-parity",
  "section_title": "Protocol Self-Improvement System",
  "section_type": "reference",
  "phase": "ALL",
  "order_index": 200,
  "content": "## Protocol Self-Improvement System\n\n**Purpose**: Continuous protocol evolution based on evidence from retrospectives.\n\n### When to Use\n\n**Monthly or After 5-10 Completed SDs**:\n```bash\nnode scripts/analyze-retrospectives-for-protocol-improvements.mjs\n```\n\n**When Recurring Issues Detected**:\n- Same pain point in ≥2 retrospectives\n- Testing gaps, validation failures, process inefficiencies\n- High-impact process improvements identified\n\n### Quick Commands\n\n**Analyze Patterns**:\n```bash\n# Analyze all retrospectives for improvement patterns\nnode scripts/analyze-retrospectives-for-protocol-improvements.mjs\n\n# Output: Top pain points, success patterns, critical lessons\n```\n\n**Apply Improvements**:\n```bash\n# Apply high-impact improvements to protocol\nnode scripts/add-protocol-improvements-from-retrospectives.mjs\n\n# Updates leo_protocol_sections, leo_handoff_templates\n```\n\n**Regenerate Context**:\n```bash\n# After applying improvements, regenerate CLAUDE.md\nnode scripts/generate-claude-md-from-db.js\n```\n\n### How It Works\n\n1. **Retrospectives Created**: protocol_improvements[] array captures learnings\n2. **Patterns Detected**: Analysis script finds recurring issues (≥2 mentions)\n3. **Improvements Applied**: High-impact changes update protocol tables\n4. **Effectiveness Tracked**: Subsequent retrospectives measure impact\n\n### Evidence-Based Thresholds\n\n**Auto-Apply** (no approval needed):\n- Pain point in ≥3 retrospectives\n- High-impact with ≥2 evidence SDs\n- Critical blocking issues\n\n**Review Required**:\n- Pain point in 2 retrospectives\n- Medium-impact with 1 evidence SD\n- Enhancement recommendations\n\n### Database Tables\n\n**retrospectives.protocol_improvements**: JSONB array of improvement objects\n```json\n{\n  \"category\": \"testing|validation|sub_agent|handoff\",\n  \"improvement\": \"Description of needed change\",\n  \"evidence\": \"SD-XXX specific evidence\",\n  \"impact\": \"Expected benefit\",\n  \"affected_phase\": \"LEAD|PLAN|EXEC|null\"\n}\n```\n\n**v_protocol_improvements_analysis**: Flattened view for querying\n\n**get_all_protocol_improvements(since_date)**: Helper function to extract improvements\n\n### Success Patterns (Evidence)\n\n**Testing Enforcement** (SD-EXPORT-001, SD-EVA-MEETING-002):\n- Problem: Tests not run before completion → 30-min gap, 67% failure rate\n- Improvement: MANDATORY dual test execution (unit + E2E)\n- Impact: Zero testing gaps in next 8 SDs\n\n**User Story Validation** (SD-EVA-MEETING-001):\n- Problem: User stories created retroactively\n- Improvement: 100% E2E test coverage with US-XXX mapping\n- Impact: Saves 1-2 hours per SD, zero retroactive work\n\n**Sub-Agent Auto-Trigger** (SD-EXPORT-001):\n- Problem: QA sub-agent manually triggered\n- Improvement: Handoff scripts enforce QA execution\n- Impact: Zero \"forgot to run QA\" incidents\n\n### Full Documentation\n\nSee: `docs/reference/protocol-self-improvement.md`\n\n**Topics Covered**:\n- Architecture flow diagram\n- Database schema details\n- Extraction and analysis process\n- Improvement types and targets\n- Effectiveness tracking metrics\n- Commands reference\n- Database-first enforcement\n- Success patterns with evidence\n\n---\n\n**When to Load**: On-demand when discussing protocol evolution, retrospective analysis, or recurring issues.\n\n**Evidence Base**: 74+ retrospectives analyzed, system continuously improving since 2025-12-04.\n\n**Related**: SD-LEO-LEARN-001 (Proactive Learning Integration)",
  "metadata": {
    "context_tier": "REFERENCE",
    "load_trigger": "protocol improvement, retrospective analysis, recurring issues",
    "evidence_base": "74+ retrospectives",
    "active_since": "2025-12-04",
    "effectiveness_validated": true
  },
  "created_at": "2025-12-10T00:00:00Z",
  "updated_at": "2025-12-10T00:00:00Z"
}
